import{r as v,c as Ce,j as s,u as Ie,a as Ne,t as b}from"./index-BIA9nVWk.js";import{i as Se,c as Te,j as Pe,P as M,e as E,d as _e,u as Ae,a as S,B as w,A as K,o as L,p as q,q as B,r as z,s as G,t as Q,v as Y,w as Z}from"./api-CF1mdzCj.js";import{u as _}from"./useMutation-BUAWeYRL.js";import{i as oe,j as De,I as Me,T as Oe}from"./topbar-Fz-IxQaZ.js";import{T as Ve}from"./textarea-B07UdKsX.js";import{I as Re}from"./input-B0zk7gIF.js";import{C as X,a as ee,b as se,d as te}from"./card-D4NqIVBJ.js";import{T as Fe,a as Ee,b as U,c as T,d as Ue,e as N}from"./table-ESroElt8.js";import{S as re}from"./switch-CuvsaitH.js";import{B as A}from"./badge-BHqjMmc7.js";import{D as $e,g as We,a as He,b as Je,c as Ke,f as Le}from"./dialog-BP6ZPIJ4.js";import{c as O}from"./utils-CBfrqCZ4.js";import"./index-B103vlTN.js";var V="Tabs",[qe]=Te(V,[oe]),le=oe(),[Be,$]=qe(V),ce=v.forwardRef((e,n)=>{const{__scopeTabs:l,value:r,onValueChange:o,defaultValue:t,orientation:c="horizontal",dir:f,activationMode:h="automatic",...m}=e,d=Ce(f),[u,i]=Se({prop:r,onChange:o,defaultProp:t??"",caller:V});return s.jsx(Be,{scope:l,baseId:Pe(),value:u,onValueChange:i,orientation:c,dir:d,activationMode:h,children:s.jsx(M.div,{dir:d,"data-orientation":c,...m,ref:n})})});ce.displayName=V;var pe="TabsList",de=v.forwardRef((e,n)=>{const{__scopeTabs:l,loop:r=!0,...o}=e,t=$(pe,l),c=le(l);return s.jsx(De,{asChild:!0,...c,orientation:t.orientation,dir:t.dir,loop:r,children:s.jsx(M.div,{role:"tablist","aria-orientation":t.orientation,...o,ref:n})})});de.displayName=pe;var ue="TabsTrigger",he=v.forwardRef((e,n)=>{const{__scopeTabs:l,value:r,disabled:o=!1,...t}=e,c=$(ue,l),f=le(l),h=xe(c.baseId,r),m=ge(c.baseId,r),d=r===c.value;return s.jsx(Me,{asChild:!0,...f,focusable:!o,active:d,children:s.jsx(M.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":m,"data-state":d?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:h,...t,ref:n,onMouseDown:E(e.onMouseDown,u=>{!o&&u.button===0&&u.ctrlKey===!1?c.onValueChange(r):u.preventDefault()}),onKeyDown:E(e.onKeyDown,u=>{[" ","Enter"].includes(u.key)&&c.onValueChange(r)}),onFocus:E(e.onFocus,()=>{const u=c.activationMode!=="manual";!d&&!o&&u&&c.onValueChange(r)})})})});he.displayName=ue;var fe="TabsContent",me=v.forwardRef((e,n)=>{const{__scopeTabs:l,value:r,forceMount:o,children:t,...c}=e,f=$(fe,l),h=xe(f.baseId,r),m=ge(f.baseId,r),d=r===f.value,u=v.useRef(d);return v.useEffect(()=>{const i=requestAnimationFrame(()=>u.current=!1);return()=>cancelAnimationFrame(i)},[]),s.jsx(_e,{present:o||d,children:({present:i})=>s.jsx(M.div,{"data-state":d?"active":"inactive","data-orientation":f.orientation,role:"tabpanel","aria-labelledby":h,hidden:!i,id:m,tabIndex:0,...c,ref:n,style:{...e.style,animationDuration:u.current?"0s":void 0},children:i&&t})})});me.displayName=fe;function xe(e,n){return`${e}-trigger-${n}`}function ge(e,n){return`${e}-content-${n}`}var ze=ce,Ge=de,Qe=he,Ye=me;function Ze({className:e,...n}){return s.jsx(ze,{"data-slot":"tabs",className:O("flex flex-col gap-2",e),...n})}function Xe({className:e,...n}){return s.jsx(Ge,{"data-slot":"tabs-list",className:O("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",e),...n})}function ae({className:e,...n}){return s.jsx(Qe,{"data-slot":"tabs-trigger",className:O("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...n})}function ie({className:e,...n}){return s.jsx(Ye,{"data-slot":"tabs-content",className:O("flex-1 outline-none",e),...n})}function D(e){try{let n=e.replace(/-/g,"+").replace(/_/g,"/");const l=n.length%4;return l&&(n+="=".repeat(4-l)),decodeURIComponent(escape(atob(n)))}catch(n){return console.error("Base64 decode error:",n),""}}function es(e){const n={};if(!e)return n;const l=e.split("&");for(const r of l){const[o,t]=r.split("=");o&&(n[decodeURIComponent(o)]=t?decodeURIComponent(t):"")}return n}function ss(e){try{const n=e.substring(8),l=D(n);if(!l)return null;const r=JSON.parse(l),o={name:r.ps||r.name||"VMess Node",type:"vmess",server:r.add||r.address||"",port:parseInt(r.port)||0,uuid:r.id||"",alterId:parseInt(r.aid)||0,cipher:r.scy||"auto",network:r.net||"tcp",tls:r.tls==="tls"||r.tls===!0};return r.sni?o.servername=r.sni:r.host&&r.tls&&(o.servername=r.host),r.alpn&&(o.alpn=typeof r.alpn=="string"?r.alpn.split(","):r.alpn),r.fp&&(o.fp=r.fp),r.allowInsecure!==void 0&&(o.skipCertVerify=r.allowInsecure===!0||r.allowInsecure==="1"||r.allowInsecure===1),r.net==="ws"&&(o["ws-opts"]={path:r.path||"/",headers:r.host?{Host:r.host}:{}}),r.net==="h2"&&(o["h2-opts"]={host:r.host?Array.isArray(r.host)?r.host:[r.host]:[],path:r.path||"/"}),r.net==="grpc"&&(o["grpc-opts"]={"grpc-service-name":r.path||r["grpc-service-name"]||""}),o}catch(n){return console.error("Parse VMess error:",n),null}}function ts(e){try{const n=e.substring(5);let l="SS Node",r=n;if(n.includes("#")){const h=n.split("#");r=h[0],l=decodeURIComponent(h[1])}let o="",t=0,c="",f="";if(r.includes("@")){const[h,m]=r.split("@"),d=D(h),[u,i]=d.split(":");c=u,f=i;const[g,j]=m.split(":");o=g,t=parseInt(j)||0}else{const h=D(r),m=h.lastIndexOf("@");if(m===-1)return null;const d=h.substring(0,m),u=h.substring(m+1),[i,g]=d.split(":");c=i,f=g;const[j,C]=u.split(":");o=j,t=parseInt(C)||0}return{name:l,type:"ss",server:o,port:t,cipher:c,password:f}}catch(n){return console.error("Parse Shadowsocks error:",n),null}}function rs(e){try{const n=e.substring(8);let l="SOCKS Node",r=n;if(n.includes("#")){const i=n.split("#");r=i[0],l=decodeURIComponent(i[1])}const[o,t]=r.split("@"),c=D(o),[f,h]=c.split(":"),[m,d]=t.split(":"),u=parseInt(d)||0;return{name:l,type:"socks5",server:m,port:u,username:f,password:h}}catch(n){return console.error("Parse SOCKS error:",n),null}}function P(e,n){try{const l=e.substring(`${n}://`.length);let r=`${n.toUpperCase()} Node`,o=l;if(l.includes("#")){const g=l.lastIndexOf("#");o=l.substring(0,g),r=decodeURIComponent(l.substring(g+1))}let t={},c=o;if(o.includes("?")){const[g,j]=o.split("?");c=g,t=es(j)}const f=c.lastIndexOf("@");if(f===-1)return null;const h=c.substring(0,f),m=c.substring(f+1);let d="",u=0;if(m.startsWith("[")){const g=m.indexOf("]");if(g!==-1){const j=m.substring(1,g),C=m.substring(g+1);u=parseInt(C.replace(":",""))||0,n==="hysteria2"||n==="hysteria"?d=m.substring(0,g+1):d=j}}else{const g=m.split(":");d=g[0],u=parseInt(g[g.length-1])||0}const i={name:r,type:n,server:d,port:u};switch(n){case"trojan":i.password=h,i.sni=t.sni||t.peer||t.host||d,i.network=t.type||"tcp",t.security&&(i.security=t.security),t.type==="ws"?i["ws-opts"]={path:t.path||"/",headers:t.host?{Host:t.host}:{}}:t.type==="grpc"?i["grpc-opts"]={"grpc-service-name":t.serviceName||t.path||""}:(t.type==="h2"||t.type==="http")&&(i["h2-opts"]={host:t.host?[t.host]:[],path:t.path||"/"}),t.alpn&&(i.alpn=t.alpn.split(",")),t.fp&&(i.fp=t.fp),i.skipCertVerify=t.allowInsecure==="1"||t["skip-cert-verify"]==="1";break;case"vless":i.password=h,i.uuid=h,i.flow=t.flow||"",i.security=t.security||"none",i.tls=t.security==="tls"||t.security==="reality",i.network=t.type||"tcp",i.sni=t.sni||d,i.servername=t.sni||d,i.skipCertVerify=t.allowInsecure==="1",t.security==="reality"&&(i.pbk=t.pbk||"",i.sid=t.sid||"",i.spx=t.spx||"",i.fp=t.fp||"",i["public-key"]=t.pbk||"",i["short-id"]=t.sid||""),t.type==="ws"?i["ws-opts"]={path:t.path||"/",headers:t.host?{Host:t.host}:{}}:t.type==="grpc"?i["grpc-opts"]={"grpc-service-name":t.serviceName||t.path||""}:(t.type==="h2"||t.type==="http")&&(i["h2-opts"]={host:t.host?[t.host]:[],path:t.path||"/"}),t.alpn&&(i.alpn=t.alpn.split(",")),t.host&&(i.host=t.host),t.path&&(i.path=t.path),t.headerType&&(i.headerType=t.headerType);break;case"hysteria":case"hysteria2":i.password=h,i.auth=h,i.ports=t.mport||u.toString(),i.obfs=t.obfs,i["obfs-password"]=t.obfsParam,i.sni=t.peer||t.sni||(d.startsWith("[")?"":d),i.alpn=t.alpn?t.alpn.split(","):void 0,i.skipCertVerify=!1,i.up=t.up||t.upmbps,i.down=t.down||t.downmbps,i.fp=t.fp||"chrome";break;case"tuic":i.uuid=h,i.password=t.password||"",i.sni=t.sni||d,i.alpn=t.alpn?t.alpn.split(","):["h3"],i.skipCertVerify=t.allowInsecure==="1",i["congestion-controller"]=t.congestion_control||"bbr",i["udp-relay-mode"]=t.udp_relay_mode||"native";break}return i}catch(l){return console.error(`Parse ${n} error:`,l),null}}function as(e){return!e||typeof e!="string"?null:(e=e.trim(),e.startsWith("vmess://")?ss(e):e.startsWith("ss://")?ts(e):e.startsWith("socks://")?rs(e):e.startsWith("trojan://")?P(e,"trojan"):e.startsWith("vless://")?P(e,"vless"):e.startsWith("hysteria://")?P(e,"hysteria"):e.startsWith("hy2://")?P(e.replace("hy2://","hysteria2://"),"hysteria2"):e.startsWith("hysteria2://")?P(e,"hysteria2"):e.startsWith("tuic://")?P(e,"tuic"):null)}function is(e){const n={pbk:"public-key",sid:"short-id",spx:"spider-x",fp:"client-fingerprint",sni:"servername",alpn:"alpn",allowInsecure:"skip-cert-verify",skipCertVerify:"skip-cert-verify",servername:"servername","public-key":"public-key","short-id":"short-id","spider-x":"spider-x",fingerprint:"fingerprint","skip-cert-verify":"skip-cert-verify"},l=new Set(["name","type","server","port","pbk","sid","spx","fp","allowInsecure","skipCertVerify","sni","password","auth","security","fingerprint"]),r={name:e.name,type:e.type,server:e.server,port:e.port};if(e.uuid?r.uuid=e.uuid:e.password&&e.type!=="vless"&&e.type!=="hysteria2"&&e.type!=="hysteria"&&(r.password=e.password),(e.type==="hysteria2"||e.type==="hysteria")&&(e.auth?r.auth=e.auth:e.password&&(r.auth=e.password)),(e.type==="socks5"||e.type==="socks")&&(e.username&&(r.username=e.username),e.password&&(r.password=e.password)),e.security?e.type==="vless"?r.tls=e.security==="tls"||e.security==="reality":e.type==="trojan"?(r.tls=!0,e.sni&&(r.sni=e.sni)):e.tls!==void 0&&(r.tls=e.tls):e.tls!==void 0?r.tls=e.tls:e.type==="trojan"&&(r.tls=!0),e.flow&&(r.flow=e.flow),e.security==="reality"?r["skip-cert-verify"]=!0:e.skipCertVerify!==void 0?r["skip-cert-verify"]=e.skipCertVerify:e.allowInsecure!==void 0&&(r["skip-cert-verify"]=e.allowInsecure),e.security==="reality"){const o={};(e.pbk||e["public-key"])&&(o["public-key"]=e["public-key"]||e.pbk),(e.sid!==void 0||e["short-id"]!==void 0)&&(o["short-id"]=e["short-id"]||e.sid||""),r["reality-opts"]=o}(e.fp||e.fingerprint)&&(r["client-fingerprint"]=e.fingerprint||e.fp),e.network&&(r.network=e.network),e.alpn&&(r.alpn=e.alpn),e.cipher&&(r.cipher=e.cipher),e.type==="vmess"&&(e.alterId!==void 0&&(r.alterId=e.alterId),r.tfo===void 0&&(r.tfo=!1));for(const[o,t]of Object.entries(e))if(t!==void 0&&!l.has(o)&&!r.hasOwnProperty(o)&&o!=="tls"&&o!=="security"&&o!=="sni"){const c=n[o]||o;r.hasOwnProperty(c)||(r[c]=t)}return r}const ns={vmess:"bg-blue-500/10 text-blue-700 dark:text-blue-400",vless:"bg-purple-500/10 text-purple-700 dark:text-purple-400",trojan:"bg-red-500/10 text-red-700 dark:text-red-400",ss:"bg-green-500/10 text-green-700 dark:text-green-400",socks5:"bg-yellow-500/10 text-yellow-700 dark:text-yellow-400",hysteria:"bg-pink-500/10 text-pink-700 dark:text-pink-400",hysteria2:"bg-indigo-500/10 text-indigo-700 dark:text-indigo-400",tuic:"bg-cyan-500/10 text-cyan-700 dark:text-cyan-400"},ne=["vmess","vless","trojan","ss","socks5","hysteria","hysteria2","tuic"];function bs(){const{auth:e}=Ie(),n=Ne(),[l,r]=v.useState(""),[o,t]=v.useState(""),[c,f]=v.useState([]),[h,m]=v.useState("all"),{data:d}=Ae({queryKey:["nodes"],queryFn:async()=>(await S.get("/api/nodes")).data,enabled:!!e.accessToken}),u=d?.nodes??[],i=_({mutationFn:async a=>{const x=a.map(y=>({raw_url:y.rawUrl,node_name:y.parsed?.name||"未知",protocol:y.parsed?.type||"unknown",parsed_config:y.parsed?JSON.stringify(y.parsed):"",clash_config:y.clash?JSON.stringify(y.clash):"",enabled:y.enabled}));return(await S.post("/api/nodes/batch",{nodes:x})).data},onSuccess:()=>{n.invalidateQueries({queryKey:["nodes"]}),b.success("节点保存成功"),r(""),f([])},onError:a=>{b.error(a.response?.data?.error||"保存失败")}}),g=_({mutationFn:async({id:a,enabled:x})=>{const p=u.find(k=>k.id===a);return p?(await S.put(`/api/nodes/${a}`,{raw_url:p.raw_url,node_name:p.node_name,protocol:p.protocol,parsed_config:p.parsed_config,clash_config:p.clash_config,enabled:x})).data:void 0},onSuccess:()=>{n.invalidateQueries({queryKey:["nodes"]})},onError:a=>{b.error(a.response?.data?.error||"更新失败")}}),j=_({mutationFn:async a=>{await S.delete(`/api/nodes/${a}`)},onSuccess:()=>{n.invalidateQueries({queryKey:["nodes"]}),b.success("节点已删除")},onError:a=>{b.error(a.response?.data?.error||"删除失败")}}),C=_({mutationFn:async()=>{await S.post("/api/nodes/clear")},onSuccess:()=>{n.invalidateQueries({queryKey:["nodes"]}),b.success("所有节点已清空")},onError:a=>{b.error(a.response?.data?.error||"清空失败")}}),R=_({mutationFn:async a=>(await S.post("/api/nodes/fetch-subscription",{url:a})).data,onSuccess:a=>{const x=a.proxies.map(p=>{const y={name:p.name||"未知",type:p.type||"unknown",server:p.server||"",port:p.port||0,...p};return{id:Math.random().toString(36).substring(7),rawUrl:"",parsed:y,clash:p,enabled:!0}});f(x),b.success(`成功导入 ${a.count} 个节点`)},onError:a=>{b.error(a.response?.data?.error||"获取订阅失败")}}),ye=()=>{const a=l.split(`
`).filter(p=>p.trim()),x=[];for(const p of a){const y=p.trim();if(!y||!y.includes("://"))continue;const k=as(y),J=k?is(k):null;x.push({id:Math.random().toString(36).substring(7),rawUrl:y,parsed:k,clash:J,enabled:!0})}f(x)},W=()=>{if(c.length===0){b.error("没有可保存的节点");return}i.mutate(c)},ve=a=>{const x=u.find(p=>p.id===a);x&&g.mutate({id:a,enabled:!x.enabled})},be=a=>{j.mutate(a)},je=a=>{f(x=>x.filter(p=>p.id!==a)),b.success("已移除临时节点")},we=()=>{C.mutate()},ke=()=>{if(!o.trim()){b.error("请输入订阅链接");return}R.mutate(o)},I=v.useMemo(()=>{const a=u.map(p=>{let y=null,k=null;try{p.parsed_config&&(y=JSON.parse(p.parsed_config)),p.clash_config&&(k=JSON.parse(p.clash_config))}catch{}return{id:p.id.toString(),rawUrl:p.raw_url,parsed:y,clash:k,enabled:p.enabled,isSaved:!0,dbId:p.id}});return[...c.map(p=>({...p,isSaved:!1,dbId:0})),...a]},[u,c]),F=v.useMemo(()=>h==="all"?I:I.filter(a=>a.parsed?.type===h),[I,h]),H=v.useMemo(()=>{const a={all:I.length};for(const x of ne)a[x]=I.filter(p=>p.parsed?.type===x).length;return a},[I]);return s.jsxs("div",{className:"min-h-svh bg-background",children:[s.jsx(Oe,{}),s.jsx("main",{className:"mx-auto w-full max-w-7xl px-4 py-8 sm:px-6",children:s.jsxs("section",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-semibold tracking-tight",children:"节点管理"}),s.jsx("p",{className:"text-muted-foreground mt-2",children:"输入代理节点信息，每行一个节点，支持 VMess、VLESS、Trojan、Shadowsocks、Hysteria、Socks、Shadowsocks 协议。"})]}),s.jsxs(X,{children:[s.jsx(ee,{children:s.jsx(se,{children:"节点输入"})}),s.jsx(te,{children:s.jsxs(Ze,{defaultValue:"manual",className:"w-full",children:[s.jsxs(Xe,{className:"grid w-full grid-cols-2",children:[s.jsx(ae,{value:"manual",children:"手动输入"}),s.jsx(ae,{value:"subscription",children:"订阅导入"})]}),s.jsxs(ie,{value:"manual",className:"space-y-4 mt-4",children:[s.jsx(Ve,{placeholder:`vmess://eyJwcyI6IuWPsOa5vualviIsImFkZCI6ImV4YW1wbGUuY29tIiwicG9ydCI6IjQ0MyIsImlkIjoidXVpZCIsImFpZCI6IjAiLCJzY3kiOiJhdXRvIiwibmV0Ijoid3MiLCJ0bHMiOiJ0bHMifQ==
vless://uuid@example.com:443?type=ws&security=tls&path=/websocket#VLESS节点
trojan://password@example.com:443?sni=example.com#Trojan节点`,value:l,onChange:a=>r(a.target.value),className:"min-h-[200px] font-mono text-sm"}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(w,{onClick:ye,disabled:!l.trim(),variant:"outline",children:"解析节点"}),s.jsx(w,{onClick:W,disabled:c.length===0||i.isPending,children:i.isPending?"保存中...":"保存节点"})]})]}),s.jsxs(ie,{value:"subscription",className:"space-y-4 mt-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Re,{placeholder:"https://example.com/api/clash/subscribe?token=xxx",value:o,onChange:a=>t(a.target.value),className:"font-mono text-sm"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"请输入 Clash 订阅链接，系统将自动获取并解析节点"})]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(w,{onClick:ke,disabled:!o.trim()||R.isPending,variant:"outline",children:R.isPending?"导入中...":"导入节点"}),s.jsx(w,{onClick:W,disabled:c.length===0||i.isPending,children:i.isPending?"保存中...":"保存节点"})]})]})]})})]}),I.length>0&&s.jsxs(X,{children:[s.jsx(ee,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{children:s.jsxs(se,{children:["节点列表 (",F.length,")"]})}),u.length>0&&s.jsxs(K,{children:[s.jsx(L,{asChild:!0,children:s.jsx(w,{variant:"destructive",size:"sm",disabled:C.isPending,children:C.isPending?"清空中...":"清空所有"})}),s.jsxs(q,{children:[s.jsxs(B,{children:[s.jsx(z,{children:"确认清空所有节点"}),s.jsxs(G,{children:["确定要清空所有已保存的节点吗？此操作不可撤销，将删除 ",u.length," 个节点。"]})]}),s.jsxs(Q,{children:[s.jsx(Y,{children:"取消"}),s.jsx(Z,{onClick:we,children:"清空所有"})]})]})]})]})}),s.jsxs(te,{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs(w,{size:"sm",variant:h==="all"?"default":"outline",onClick:()=>m("all"),children:["全部 (",H.all,")"]}),ne.map(a=>{const x=H[a]||0;return x===0?null:s.jsxs(w,{size:"sm",variant:h===a?"default":"outline",onClick:()=>m(a),children:[a.toUpperCase()," (",x,")"]},a)})]}),s.jsx("div",{className:"rounded-md border overflow-auto",children:s.jsxs(Fe,{children:[s.jsx(Ee,{children:s.jsxs(U,{children:[s.jsx(T,{className:"w-[100px]",children:"协议"}),s.jsx(T,{className:"min-w-[150px]",children:"节点名称"}),s.jsx(T,{className:"min-w-[200px]",children:"服务器地址"}),s.jsx(T,{className:"min-w-[200px]",children:"Clash 配置"}),s.jsx(T,{className:"w-[80px] text-center",children:"启用"}),s.jsx(T,{className:"w-[100px] text-center",children:"操作"})]})}),s.jsx(Ue,{children:F.length===0?s.jsx(U,{children:s.jsx(N,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"没有找到匹配的节点"})}):F.map(a=>s.jsxs(U,{children:[s.jsx(N,{children:a.parsed?s.jsx(A,{variant:"outline",className:ns[a.parsed.type]||"bg-gray-500/10",children:a.parsed.type.toUpperCase()}):s.jsx(A,{variant:"destructive",children:"解析失败"})}),s.jsx(N,{className:"font-medium",children:s.jsxs("div",{className:"flex items-center gap-2",children:[a.parsed?.name||"未知",a.isSaved&&s.jsx(A,{variant:"secondary",className:"text-xs",children:"已保存"})]})}),s.jsx(N,{children:s.jsx("div",{className:"text-sm text-muted-foreground",children:a.parsed?s.jsxs("div",{children:[s.jsxs("div",{className:"font-mono",children:[a.parsed.server,":",a.parsed.port]}),a.parsed.network&&a.parsed.network!=="tcp"&&s.jsx("div",{className:"text-xs mt-1",children:s.jsx(A,{variant:"outline",className:"text-xs",children:a.parsed.network})})]}):"-"})}),s.jsx(N,{children:a.clash?s.jsxs($e,{children:[s.jsx(We,{asChild:!0,children:s.jsx(w,{variant:"ghost",size:"sm",className:"h-auto py-1 px-2",children:s.jsxs("div",{className:"text-xs font-mono text-left truncate max-w-[180px]",children:[JSON.stringify(a.clash).substring(0,50),"..."]})})}),s.jsxs(He,{className:"max-w-2xl max-h-[80vh] overflow-auto",children:[s.jsxs(Je,{children:[s.jsx(Ke,{children:"Clash 配置详情"}),s.jsx(Le,{children:a.parsed?.name||"未知"})]}),s.jsx("div",{className:"mt-4",children:s.jsx("pre",{className:"text-xs bg-muted p-4 rounded overflow-auto",children:JSON.stringify(a.clash,null,2)})})]})]}):s.jsx("span",{className:"text-xs text-muted-foreground",children:"转换失败"})}),s.jsx(N,{className:"text-center",children:a.isSaved?s.jsx(re,{checked:a.enabled,onCheckedChange:()=>ve(a.dbId)}):s.jsx(re,{checked:a.enabled,disabled:!0})}),s.jsx(N,{className:"text-center",children:s.jsxs(K,{children:[s.jsx(L,{asChild:!0,children:s.jsx(w,{variant:"ghost",size:"sm",disabled:a.isSaved&&j.isPending,children:"删除"})}),s.jsxs(q,{children:[s.jsxs(B,{children:[s.jsx(z,{children:"确认删除"}),s.jsxs(G,{children:['确定要删除节点 "',a.parsed?.name||"未知",'" 吗？',a.isSaved&&"此操作不可撤销。"]})]}),s.jsxs(Q,{children:[s.jsx(Y,{children:"取消"}),s.jsx(Z,{onClick:()=>a.isSaved?be(a.dbId):je(a.id),children:"删除"})]})]})]})})]},a.id))})]})})]})]})]})})]})}export{bs as component};
